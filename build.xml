<?xml version="1.0"?>
<project name="Erebot" description="" default="all">
    <property name="domain" value="Erebot"/>
    <property name="version" value="0.5.1"/>
    <property name="email" value="clicky@erebot.net"/>
    <property name="qa.coverage.force" value="false"/>

    <fileset dir="src/" id="sources">
        <include name="**/*.php"/>
        <exclude name="orm/**"/>
        <exclude name="logging/**"/>
    </fileset>

    <fileset dir="tests/" id="tests">
        <include name="**/*.php"/>
    </fileset>

    <target name="protected_set_version">
        <!-- Set Erebot_Interface_Core::VERSION. -->
        <exec command="sed -i &quot;s/define.*EREBOT_VERSION.*/define('EREBOT_VERSION', '${version}');/&quot; src/Erebot/Interface/Core.php" checkreturn="true"/>

        <!-- Set version in example configurations. -->
        <!-- * Single file configuration -->
        <exec command="xmlstarlet ed -P -S -u &quot;/configuration/@version&quot; -v ${version} examples/Erebot-single-file.xml.dist &gt; /tmp/${phing.project.name}~" escape="false" checkreturn="true" logoutput="true"/>
        <move file="/tmp/${phing.project.name}~" tofile="examples/Erebot-single-file.xml" haltonerror="true" overwrite="true"/>
        <!-- * Multiple file configuration -->
        <exec command="xmlstarlet ed -P -S -u &quot;/configuration/@version&quot; -v ${version} examples/Erebot-multiple-files.xml.dist &gt; /tmp/${phing.project.name}~" escape="false" checkreturn="true" logoutput="true"/>
        <move file="/tmp/${phing.project.name}~" tofile="examples/Erebot-multiple-files.xml" haltonerror="true" overwrite="true"/>
    </target>

    <import file="buildenv/build.xml"/>
</project>
